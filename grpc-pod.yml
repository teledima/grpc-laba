apiVersion: v1
kind: Pod
metadata: 
  name: grpc-pod
  labels:
    app: grpc-service
spec:

  restartPolicy: Always
  volumes:
  - name: postgres-init-volume
    hostPath:
      path: /grpc-laba

  containers:  
    - image: postgres:14
      name: postgres
      env:
        - name: POSTGRES_DB
          value: games
        - name: POSTGRES_PASSWORD
          value: postgres
        - name: POSTGRES_USER
          value: postgres
      ports:
        - containerPort: 5432
      resources: {}
      volumeMounts:
        - mountPath: /docker-entrypoint-initdb.d/init.sql
          name: postgres-init-volume
    
    - image: docker.io/teledima/grpc-server:v1
      name: grpc-server
      env:
        - name: POSTGRES_DB
          value: games
        - name: POSTGRES_HOST
          value: postgres
        - name: POSTGRES_PASSWORD
          value: postgres
        - name: POSTGRES_PORT
          value: "5432"
        - name: POSTGRES_USER
          value: postgres
      ports:
        - containerPort: 5001
